# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
**–§–∞–π–ª:** `.env`
**–ü—Ä–æ–±–ª–µ–º–∞:** OAuth —Ç–æ–∫–µ–Ω Yandex Cloud —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ —Ñ–∞–π–ª–µ `.env`
**–†–∏—Å–∫:** –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –æ–±–ª–∞—á–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
**–†–µ—à–µ–Ω–∏–µ:** 
- –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `.env` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –î–æ–±–∞–≤–∏—Ç—å `.env` –≤ `.gitignore` (—É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 2. –ü–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∫–æ–¥–µ
**–§–∞–π–ª—ã:** 
- `ansible/group_vars/vault.yml`
- `setup_zabbix_remote.ps1`
- `setup_zabbix_db.sql`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ –∫–æ–¥–µ
**–†–∏—Å–∫:** –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Ansible Vault –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏

### 3. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SSH –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
**–§–∞–π–ª:** `ansible/ansible.cfg`
**–ü—Ä–æ–±–ª–µ–º–∞:** 
- `host_key_checking = False`
- `StrictHostKeyChecking=no`

**–†–∏—Å–∫:** Man-in-the-middle –∞—Ç–∞–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–µ–π —Ö–æ—Å—Ç–æ–≤

## üü° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### 1. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ SSH –∫–ª—é—á–∞–º
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤–µ–∑–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (600)
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞ 600 –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π

### 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ Ansible
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `no_log: true` –¥–ª—è –∑–∞–¥–∞—á —Å –ø–∞—Ä–æ–ª—è–º–∏

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ SSL/TLS
**–ü—Ä–æ–±–ª–µ–º–∞:** Elasticsearch –∏ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

## ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–§–∞–π–ª .gitignore** –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
2. **SSH –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á–∞–º
3. **Firewall –ø—Ä–∞–≤–∏–ª–∞** –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ root –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ansible Vault

```bash
# –°–æ–∑–¥–∞—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –ø–∞—Ä–æ–ª—è–º–∏
ansible-vault create ansible/group_vars/vault.yml

# –°–æ–¥–µ—Ä–∂–∏–º–æ–µ vault.yml:
vault_mysql_root_password: "{{ lookup('password', '/dev/null length=32 chars=ascii_letters,digits') }}"
vault_zabbix_db_password: "{{ lookup('password', '/dev/null length=32 chars=ascii_letters,digits') }}"
```

### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH

```ini
# ansible/ansible.cfg
[defaults]
host_key_checking = True
remote_user = ubuntu
private_key_file = ../ssh_key.pem

[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=yes
```

### 3. SSL/TLS –¥–ª—è Elasticsearch

```yaml
# –î–æ–±–∞–≤–∏—Ç—å –≤ elasticsearch.yml.j2
xpack.security.enabled: true
xpack.security.http.ssl.enabled: true
xpack.security.transport.ssl.enabled: true
```

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–¥–∞—á–∏ Ansible

```yaml
- name: Set MySQL root password
  mysql_user:
    name: root
    password: "{{ mysql_root_password }}"
    login_unix_socket: /var/run/mysqld/mysqld.sock
  no_log: true  # –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å
```

## üõ°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —Å–∏—Å—Ç–µ–º—ã –∏ –ø–∞–∫–µ—Ç–æ–≤
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** —á–µ—Ä–µ–∑ Zabbix
3. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
4. **–ê—É–¥–∏—Ç –ª–æ–≥–æ–≤** –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
5. **–†–æ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π** –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π
6. **–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

## üìã –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [ ] –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `.env` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Ansible Vault –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
- [ ] –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSH –∫–ª—é—á–µ–π —Ö–æ—Å—Ç–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL/TLS –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å `no_log: true` –¥–ª—è –∑–∞–¥–∞—á —Å –ø–∞—Ä–æ–ª—è–º–∏
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª—é—á–∞–º
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üö® –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–°–†–û–ß–ù–û:** –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `.env` –∏ —Å–º–µ–Ω–∏—Ç—å OAuth —Ç–æ–∫–µ–Ω
2. **–°–†–û–ß–ù–û:** –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ vault.yml
3. **–°–†–û–ß–ù–û:** –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSH –∫–ª—é—á–µ–π
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL/TLS –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
5. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏